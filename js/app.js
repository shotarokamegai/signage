!function t(r,n,e){function o(s,u){if(!n[s]){if(!r[s]){var c="function"==typeof require&&require;if(!u&&c)return c(s,!0);if(i)return i(s,!0);var h=new Error("Cannot find module '"+s+"'");throw h.code="MODULE_NOT_FOUND",h}var p=n[s]={exports:{}};r[s][0].call(p.exports,function(t){var n=r[s][1][t];return o(n?n:t)},p,p.exports,t,r,n,e)}return n[s].exports}for(var i="function"==typeof require&&require,s=0;s<e.length;s++)o(e[s]);return o}({1:[function(t){!function(){var r,n,e,o,i,s,u,c;return e=t("./Video"),r=t("./Ad"),n=t("./Signage"),s=["http://pdl.vimeocdn.com/02014/089/230012081.mp4?token2=1425872474_7564e65b8552e17db3a943c26d5b8d39","https://avvimeo-a.akamaihd.net/40223/653/137113021.mp4?token2=1425872704_827890d526908dc4b866926a3e510810"],o=["http://c4.staticflickr.com/8/7286/16129131004_20f558be87_k.jpg","http://c4.staticflickr.com/8/7605/16747512421_27180963a6_h.jpg"],i=[new e("#video",s),new r("#ad",o)],u=[1,0],c=new n(i,u),c.start()}()},{"./Ad":2,"./Signage":4,"./Video":5}],2:[function(t,r){var n,e,o=function(t,r){return function(){return t.apply(r,arguments)}},i=function(t,r){function n(){this.constructor=t}for(var e in r)s.call(r,e)&&(t[e]=r[e]);return n.prototype=r.prototype,t.prototype=new n,t.__super__=r.prototype,t},s={}.hasOwnProperty;e=t("./Controller"),n=function(t){function r(t,r){this.sources=r,this.stop=o(this.stop,this),this.$el=$(""+t),this.tid="",this.sources,this.max=this.sources.length,this.cur=-1}return i(r,t),r.timeout=15e3,r.prototype.next=function(){return this.cur+1<this.max?this.cur++:this.cur=0,this.sources[this.cur]},r.prototype.ready=function(){var t;return t=this,new Promise(function(r){return function(n){var e,o;return o=r.next(),e=new Image,$(e).on("load",function(){return t.$el.html(e),n()}),e.src=o}}(this))},r.prototype.start=function(){return r.__super__.start.call(this),this.tid=setTimeout(this.stop,r.timeout)},r.prototype.stop=function(){return this.tid=clearTimeout(this.tid),this.tid=null,this.trigger("ended")},r}(e),r.exports=n},{"./Controller":3}],3:[function(t,r){var n,e=function(t,r){function n(){this.constructor=t}for(var e in r)o.call(r,e)&&(t[e]=r[e]);return n.prototype=r.prototype,t.prototype=new n,t.__super__=r.prototype,t},o={}.hasOwnProperty;n=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return e(r,t),r.prototype.start=function(){return this.$el.addClass("active")},r.prototype.close=function(){return this.$el.removeClass("active")},r}(EventEmitter),r.exports=n},{}],4:[function(t,r){var n,e=function(t,r){return function(){return t.apply(r,arguments)}};n=function(){function t(t,r){var n,o,i,s;for(null==t&&(t=[]),null==r&&(r=[]),this.error=e(this.error,this),this.onEnd=e(this.onEnd,this),this.cur=0,this.scenes=t,this.order=r,this.max=this.order.length,this.scene=this.scenes[this.order[this.cur]],i=this.scenes,n=0,o=i.length;o>n;n++)s=i[n],s.on("ended",this.onEnd)}return t.prototype.onEnd=function(){return this.next()},t.prototype.start=function(){return this.scene.ready().then(function(t){return function(){return t.scene.start()}}(this))["catch"](this.error)},t.prototype.error=function(){return this.next()},t.prototype.getNextScene=function(){return this.cur+1<this.max?this.cur++:this.cur=0,this.scenes[this.order[this.cur]]},t.prototype.change=function(t){return this.scene.close(),this.scene=t,this.scene.start()},t.prototype.next=function(){var t;return t=this.getNextScene(),t===this.scene?this.scene.start():t.ready().then(function(r){return function(){return r.change(t)}}(this))["catch"](this.error)},t}(),r.exports=n},{}],5:[function(t,r){var n,e,o=function(t,r){return function(){return t.apply(r,arguments)}},i=function(t,r){function n(){this.constructor=t}for(var e in r)s.call(r,e)&&(t[e]=r[e]);return n.prototype=r.prototype,t.prototype=new n,t.__super__=r.prototype,t},s={}.hasOwnProperty;n=t("./Controller"),e=function(t){function r(t,r){this.stop=o(this.stop,this),this.$el=$(""+t),this.src=r,this.max=r.length,this.cur=-1}return i(r,t),r.prototype.reset=function(){return this.$el.empty()},r.prototype.nextVideo=function(){return this.cur+1<this.max?this.cur++:this.cur=0,this.src[this.cur]},r.prototype.ready=function(){return this.reset(),new Promise(function(t){return function(r,n){var e,o,i;return e=t,i=t.nextVideo(),console.log("set video "+i),o='<video src="'+i+'"></video>',$(o).appendTo(t.$el).on("error",function(){return n(10)}).on("stalled",function(){return e.stop(),n(11)}).on("abort",function(){return n(9)}).on("loadeddata",function(){return r(!0)}).on("ended",function(){return e.stop()})}}(this))},r.prototype.play=function(){return this.$el.find("video").get(0).currentTime=0,this.$el.find("video").get(0).play()},r.prototype.start=function(){return r.__super__.start.call(this),this.play()},r.prototype.stop=function(){return this.tid=clearTimeout(this.tid),this.tid=null,this.trigger("ended")},r}(n),r.exports=e},{"./Controller":3}]},{},[1]);
//# sourceMappingURL=app.js.map